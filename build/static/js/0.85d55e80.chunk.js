(this["webpackJsonpartviva-frontend"]=this["webpackJsonpartviva-frontend"]||[]).push([[0],{341:function(e,a,t){"use strict";t.r(a);var n=t(2),l=t.n(n),c=t(5),r=t(17),i=t(7),s=t(0),o=t.n(s),u=t(9),m=t(10),p=t(89),f=t(199),d=t(83),h=t(26),E=t(13),v=t(14),y=t(15),b=t(322),g=t(22),x=t(109),C=t(331),j=t(120),N=t(30),k={setNotification:m.b,createSchoolClass:p.a,updateSchoolClass:p.e};a.default=Object(u.b)((function(e){return{user:e.user}}),k)((function(e){var a=e.schoolClass,t=e.user,n=e.setNotification,u=e.createSchoolClass,m=e.updateSchoolClass,p=e.mode,k=Object(s.useState)(!1),O=Object(i.a)(k,2),S=O[0],w=O[1],I=Object(s.useState)(!1),R=Object(i.a)(I,2),V=R[0],F=R[1];Object(s.useEffect)((function(){"edit"===p&&w(!0)}),[]),Object(s.useEffect)((function(){f.a.setToken(t.token),d.a.setToken(t.token)}),[t]);var q=Object(s.useState)([]),B=Object(i.a)(q,2),G=B[0],L=B[1],U=Object(s.useState)([]),z=Object(i.a)(U,2),K=z[0],J=z[1],T=Object(s.useState)([]),A=Object(i.a)(T,2),D=A[0],H=A[1],M=function(e){""===e.pupils[0]?F(!0):F(!1)},P=function(e,a,t){0!==e.pupils.length?S?W(e):Q(e,a,t):F(!0)},Q=function(e,a,t){u(e).then((function(){n({message:"\u041d\u043e\u0432\u0438\u0439 \u043a\u043b\u0430\u0441 \u0431\u0443\u0432 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0434\u043e\u0434\u0430\u043d.",variant:"success"},5),t()})).catch((function(e){var t=Object(r.a)({},e.response.data),l=t.message;"name"===t.cause&&a({name:l}),n({message:l,variant:"danger"},5)}))},W=function(e){console.log("Updating",e),m(a.id,e).then((function(){n({message:"\u0417\u043c\u0456\u043d\u0438 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e.",variant:"success"},5)})).catch((function(e){var a=Object(r.a)({},e.response.data).message;n({message:a,variant:"danger"},5)}))},X=E.d().shape({title:E.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter class title"),info:E.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(255,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 255 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter some description"),teacher:E.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter teacher name"),specialty:E.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter teacher name"),pupils:E.a().of(E.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("\u0426\u0435 \u043f\u043e\u043b\u0435 \u0454 \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0438\u043c."))});return o.a.createElement(b.a,null,o.a.createElement("h2",{className:"text-center custom-font py-4"},S?"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438":"\u0414\u043e\u0434\u0430\u0442\u0438"," \u043a\u043b\u0430\u0441"),o.a.createElement(h.c,{initialValues:S?Object(r.a)({},a,{teacher:a.teacher.name,specialty:a.specialty.title,pupils:a.pupils.map((function(e){return e.name}))}):{title:"",info:"",teacher:"",specialty:"",pupils:[""]},enableReinitialize:!0,onSubmit:function(){var e=Object(c.a)(l.a.mark((function e(a,t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.resetForm,c=t.setErrors,e.next=3,P(a,c,n);case 3:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),validationSchema:X},(function(e){var t=e.handleSubmit,n=e.handleChange,l=e.handleBlur,c=e.values,r=e.touched,i=e.errors;return o.a.createElement(g.a,{"data-cy":"school-class-form",noValidate:!0,onSubmit:t,className:"text-left"},o.a.createElement(g.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(g.a.Group,{controlId:S?"school-class-title-input-".concat(a.id):"school-class-title-input",as:x.a,className:"mb-4"},o.a.createElement(g.a.Label,null,"\u041d\u0430\u0437\u0432\u0430 \u043a\u043b\u0430\u0441\u0443"),o.a.createElement(g.a.Control,{type:"text",name:"title","data-cy":"title-input",onChange:n,onBlur:l,value:c.title,isValid:r.title&&!i.title,isInvalid:r.title&&!!i.title}),o.a.createElement(g.a.Control.Feedback,{type:"invalid"},i.title))),o.a.createElement(g.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(g.a.Group,{controlId:S?"school-class-info-input-".concat(a.id):"school-class-info-input",as:x.a,className:"mb-4"},o.a.createElement(g.a.Label,null,"\u041e\u043f\u0438\u0441/\u0456\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u044f \u043f\u0440\u043e \u043a\u043b\u0430\u0441"),o.a.createElement(g.a.Control,{as:"textarea",rows:"3",name:"info","data-cy":"info-input",onChange:n,onBlur:l,value:c.info,isValid:r.info&&!i.info,isInvalid:r.info&&!!i.info}),o.a.createElement(g.a.Control.Feedback,{type:"invalid"},i.info))),o.a.createElement(g.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(g.a.Group,{controlId:S?"school-class-teacher-input-".concat(a.id):"school-class-teacher-input",as:x.a,className:"mb-4"},o.a.createElement(g.a.Label,null,"\u0412\u0447\u0456\u0442\u0435\u043b\u044c"),o.a.createElement(g.a.Control,{type:"text",name:"teacher","data-cy":"teacher-input",list:"teachers-list",autoComplete:"off",onChange:n,onKeyUp:function(e){return function(e){if(e.length>=2){var a={value:e};f.a.teachers(a).then((function(e){L(e)})).catch((function(e){console.error(e)}))}}(e.target.value)},onBlur:l,value:c.teacher,isValid:r.teacher&&!i.teacher,isInvalid:r.teacher&&!!i.teacher}),o.a.createElement("datalist",{id:"teachers-list"},G.map((function(e){return o.a.createElement("option",{key:e,value:e})}))),o.a.createElement(g.a.Control.Feedback,{type:"invalid"},i.teacher))),o.a.createElement(g.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(g.a.Group,{controlId:S?"school-class-specialty-input-".concat(a.id):"school-class-specialty-input",as:x.a,className:"mb-4"},o.a.createElement(g.a.Label,null,"\u0424\u0430\u0445 \u043a\u043b\u0430\u0441\u0443"),o.a.createElement(g.a.Control,{type:"text",name:"specialty","data-cy":"specialty-input",list:"specialties-list",autoComplete:"off",onChange:n,onKeyUp:function(e){return function(e){if(e.length>=2){var a={value:e};f.a.specialties(a).then((function(e){H(e)})).catch((function(e){console.error(e)}))}}(e.target.value)},onBlur:l,value:c.specialty,isValid:r.specialty&&!i.specialty,isInvalid:r.specialty&&!!i.specialty}),o.a.createElement("datalist",{id:"specialties-list"},D.map((function(e){return o.a.createElement("option",{key:e,value:e})}))),o.a.createElement(g.a.Control.Feedback,{type:"invalid"},i.specialty))),o.a.createElement(h.b,{name:"pupils",render:function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a.Label,null,"\u0423\u0447\u043d\u0456"),c.pupils&&c.pupils.length>0?c.pupils.map((function(a,t){return o.a.createElement(g.a.Row,{key:t,className:"d-flex justify-content-end"},o.a.createElement(x.a,{xs:12},o.a.createElement(g.a.Control,{type:"text",list:"pupils-list",autoComplete:"off",className:"mb-2",name:"pupils[".concat(t,"]"),value:c.pupils[t],onChange:n,onKeyUp:function(e){return function(e){if(e.length>=2){var a={value:e};f.a.pupils(a).then((function(e){J(e)})).catch((function(e){console.error(e)}))}}(e.target.value)},isValid:r.pupils&&!i.pupils}),o.a.createElement("datalist",{id:"pupils-list"},K.map((function(e){return o.a.createElement("option",{key:e,value:e})})))),o.a.createElement(x.a,{xs:8},o.a.createElement(h.a,{name:"pupils[".concat(t,"]"),className:"border border-primary",render:function(e){return o.a.createElement("span",{className:"form-validation-error-mk2"},e)}})),o.a.createElement(x.a,{xs:4,className:"my-2 align-items-end border1 border-secondary"},o.a.createElement(C.a,{className:"d-flex justify-content-center"},o.a.createElement(x.a,{className:"pr-1"},o.a.createElement(j.a,{block:!0,variant:"outline-danger",size:"sm",onClick:function(){e.remove(t),M(e.form.values)}},o.a.createElement(v.a,{icon:y.i}))),o.a.createElement(x.a,{className:"pl-1"},o.a.createElement(j.a,{block:!0,variant:"outline-success",size:"sm",onClick:function(){e.push(""),M(e.form.values)}},o.a.createElement(v.a,{icon:y.k}))))))})):o.a.createElement(j.a,{className:"my-2",variant:V?"outline-danger":"outline-primary",varialt:"outline-primary",onClick:function(){e.push(""),M(e.form.values)}},"\u0414\u043e\u0434\u0430\u0442\u0438 \u0443\u0447\u043d\u044f"))}}),o.a.createElement(g.a.Row,{className:"d-flex justify-content-center text-center"},o.a.createElement(g.a.Group,{as:x.a,className:"pt-4"},o.a.createElement(N.a,{block:!0,className:"px-4 primary-color-shadow",variant:"primary",type:"submit",label:"\u0414\u043e\u0434\u0430\u0442\u0438"}))))})))}))}}]);
//# sourceMappingURL=0.85d55e80.chunk.js.map