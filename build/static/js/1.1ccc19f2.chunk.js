(this["webpackJsonpartviva-frontend"]=this["webpackJsonpartviva-frontend"]||[]).push([[1],{342:function(e,a,t){"use strict";t.r(a);var n=t(2),r=t.n(n),c=t(5),i=t(17),s=t(44),l=t(7),o=t(0),m=t.n(o),u=t(9),p=t(10),f=t(90),d=t(84),b=t(26),E=t(13),v=t(14),h=t(15),y=t(322),j=t(22),g=t(109),N=t(331),k=t(120),O=t(30),x={setNotification:p.b,createTeacher:f.a,updateTeacher:f.e};a.default=Object(u.b)((function(e){return{user:e.user,specialties:e.specialties}}),x)((function(e){var a=e.teacher,t=e.user,n=e.specialties,u=e.setNotification,p=e.createTeacher,f=e.updateTeacher,x=e.mode,w=Object(o.useState)(!1),S=Object(l.a)(w,2),C=S[0],F=S[1],T=Object(o.useState)([]),R=Object(l.a)(T,2),V=R[0],z=R[1],I=Object(o.useState)(null),q=Object(l.a)(I,2),B=q[0],G=q[1],J=Object(o.useState)(!1),A=Object(l.a)(J,2),L=A[0],D=A[1];Object(o.useEffect)((function(){z(n.map((function(e){return e.title}))),d.a.setToken(t.token)}),[t,n]),Object(o.useEffect)((function(){if("edit"===x){F(!0);var e=new Set(n.map((function(e){return e.title}))),t=new Set(a.specialties.map((function(e){return e.title}))),r=new Set(Object(s.a)(e).filter((function(e){return!t.has(e)})));G(Array.from(r))}}),[]);var H=function(e){""===e.specialties[0]?D(!0):D(!1)},K=function(e,a,t){if(0!==e.specialties.length){var r=new Set(e.specialties),c=[];r.forEach((function(e){var a=n.findIndex((function(a){return a.title===e}));c.push(n[a].id)}));var s=Object(i.a)({},e,{specialties:c});C?P(s):M(s,a,t)}else D(!0)},M=function(e,a,t){p(e).then((function(){u({message:"\u041d\u043e\u0432\u0438\u0439 \u0432\u0447\u0456\u0442\u0435\u043b\u044c \u0431\u0443\u0432 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0434\u043e\u0434\u0430\u043d.",variant:"success"},5),t()})).catch((function(e){var t=Object(i.a)({},e.response.data),n=t.message;"name"===t.cause&&a({name:n}),u({message:n,variant:"danger"},5)}))},P=function(e){f(a.id,e).then((function(){u({message:"\u0417\u043c\u0456\u043d\u0438 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e.",variant:"success"},5)})).catch((function(e){var a=Object(i.a)({},e.response.data).message;u({message:a,variant:"danger"},5)}))},Q=E.d().shape({name:E.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u043e\u0432\u043de \u0456\u043c'\u044f."),specialties:E.a().of(E.f().oneOf(V,"\u0412\u0438 \u043f\u043e\u0432\u0438\u043d\u043d\u0456 \u0432\u0438\u0431\u0440\u0430\u0442\u0438 \u043d\u0435 \u043c\u0435\u043d\u0448\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u0444\u0430\u0445\u0443.").required("\u0426\u0435 \u043f\u043e\u043b\u0435 \u0454 \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0438\u043c."))});return m.a.createElement(y.a,null,m.a.createElement("h2",{className:"text-center custom-font py-4"},C?"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438":"\u0414\u043e\u0434\u0430\u0442\u0438"," \u0432\u0447\u0456\u0442\u0435\u043b\u044f"),m.a.createElement(b.c,{initialValues:C?Object(i.a)({},a,{specialties:a.specialties.map((function(e){return e.title}))}):{name:"",specialties:[""]},enableReinitialize:!0,onSubmit:function(){var e=Object(c.a)(r.a.mark((function e(a,t){var n,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.resetForm,c=t.setErrors,e.next=3,K(a,c,n);case 3:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),validationSchema:Q},(function(e){var t=e.handleSubmit,n=e.handleChange,r=e.handleBlur,c=e.values,i=e.touched,s=e.errors;return m.a.createElement(j.a,{"data-cy":"teacher-form",noValidate:!0,onSubmit:t,className:"text-left"},m.a.createElement(j.a.Row,{className:"d-flex justify-content-center"},m.a.createElement(j.a.Group,{controlId:C?"teacher-name-input-".concat(a.id):"teacher-name-input",as:g.a,className:"mb-4"},m.a.createElement(j.a.Label,null,"\u041f\u043e\u043b\u043d\u0435 \u0456\u043c'\u044f \u0432\u0447\u0456\u0442\u0435\u043b\u044f"),m.a.createElement(j.a.Control,{type:"text",name:"name","data-cy":"name-input",onChange:n,onBlur:r,value:c.name,isValid:i.name&&!s.name,isInvalid:i.name&&!!s.name}),m.a.createElement(j.a.Control.Feedback,{type:"invalid"},s.name))),m.a.createElement(b.b,{name:"specialties",render:function(e){return m.a.createElement(m.a.Fragment,null,c.specialties&&c.specialties.length>0?c.specialties.map((function(t,r){return m.a.createElement(j.a.Row,{key:r,className:"d-flex justify-content-end border1 border-primary"},m.a.createElement(g.a,{xs:12},m.a.createElement(j.a.Control,{as:"select",className:"mb-2",name:"specialties[".concat(r,"]"),value:c.specialties[r],onChange:n,isValid:i.specialties&&!s.specialties},C?m.a.createElement(m.a.Fragment,null,m.a.createElement("option",null,"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c..."),a.specialties.map((function(e){return m.a.createElement("option",{className:"text-primary",value:e.title,key:e.title},e.title)})),B.map((function(e){return m.a.createElement("option",{value:e,key:e},e)}))):m.a.createElement(m.a.Fragment,null,m.a.createElement("option",null,"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c..."),V.map((function(e){return m.a.createElement("option",{value:e,key:e},e)}))))),m.a.createElement(g.a,{xs:8},m.a.createElement(b.a,{name:"specialties[".concat(r,"]"),className:"border border-primary",render:function(e){return m.a.createElement("span",{className:"form-validation-error-mk2"},e)}})),m.a.createElement(g.a,{xs:4,className:"my-2 align-items-end border1 border-secondary"},m.a.createElement(N.a,{className:"d-flex justify-content-center"},m.a.createElement(g.a,{className:"pr-1"},m.a.createElement(k.a,{block:!0,variant:"outline-danger",size:"sm",onClick:function(){e.remove(r),H(e.form.values)}},m.a.createElement(v.a,{icon:h.i}))),m.a.createElement(g.a,{className:"pl-1"},m.a.createElement(k.a,{block:!0,variant:"outline-success",size:"sm",onClick:function(){e.push(""),H(e.form.values)}},m.a.createElement(v.a,{icon:h.k}))))))})):m.a.createElement(k.a,{className:"my-2",variant:L?"outline-danger":"outline-primary",onClick:function(){e.push(""),H(e.form.values)}},"\u0414\u043e\u0434\u0430\u0442\u0438 \u0444\u0430\u0445"))}}),m.a.createElement(j.a.Row,{className:"d-flex justify-content-center text-center"},m.a.createElement(j.a.Group,{as:g.a,className:"pt-4"},m.a.createElement(O.a,{block:!0,className:"px-4 primary-color-shadow",variant:"primary",type:"submit",label:"\u0414\u043e\u0434\u0430\u0442\u0438"}))))})))}))}}]);
//# sourceMappingURL=1.1ccc19f2.chunk.js.map