(this["webpackJsonpartviva-frontend"]=this["webpackJsonpartviva-frontend"]||[]).push([[0],{341:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(5),s=a(17),l=a(7),i=a(0),o=a.n(i),u=a(9),p=a(10),m=a(89),f=a(14),d=a.n(f),h="".concat("https://artviva.herokuapp.com","/api/search"),v=null,b=function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:v}},e.prev=1,e.next=4,d.a.post("".concat(h,"/teachers"),t,a);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0.response));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),E={pupils:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:v}},e.prev=1,e.next=4,d.a.post("".concat(h,"/pupils"),t,a);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0.response));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),teachers:b,specialties:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:v}},e.prev=1,e.next=4,d.a.post("".concat(h,"/specialties"),t,a);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0.response));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){v="bearer ".concat(e)}},y=a(83),x=a(26),j=a(11),g=a(13),k=a(15),N=a(321),C=a(22),O=a(109),w=a(330),S=a(120),I=a(30),R={setNotification:p.b,createSchoolClass:m.a,updateSchoolClass:m.e};t.default=Object(u.b)((function(e){return{user:e.user}}),R)((function(e){var t=e.schoolClass,a=e.user,n=e.setNotification,u=e.createSchoolClass,p=e.updateSchoolClass,m=e.mode,f=Object(i.useState)(!1),d=Object(l.a)(f,2),h=d[0],v=d[1],b=Object(i.useState)(!1),R=Object(l.a)(b,2),V=R[0],z=R[1];Object(i.useEffect)((function(){"edit"===m&&v(!0)}),[]),Object(i.useEffect)((function(){E.setToken(a.token),y.a.setToken(a.token)}),[a]);var F=Object(i.useState)([]),q=Object(l.a)(F,2),B=q[0],G=q[1],L=Object(i.useState)([]),U=Object(l.a)(L,2),A=U[0],K=U[1],P=Object(i.useState)([]),T=Object(l.a)(P,2),J=T[0],D=T[1],H=function(e){""===e.pupils[0]?z(!0):z(!1)},M=function(e,t,a){0!==e.pupils.length?h?W(e):Q(e,t,a):z(!0)},Q=function(e,t,a){u(e).then((function(){n({message:"\u041d\u043e\u0432\u0438\u0439 \u043a\u043b\u0430\u0441 \u0431\u0443\u0432 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0434\u043e\u0434\u0430\u043d.",variant:"success"},5),a()})).catch((function(e){var a=Object(s.a)({},e.response.data),r=a.message;"name"===a.cause&&t({name:r}),n({message:r,variant:"danger"},5)}))},W=function(e){console.log("Updating",e),p(t.id,e).then((function(){n({message:"\u0417\u043c\u0456\u043d\u0438 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e.",variant:"success"},5)})).catch((function(e){var t=Object(s.a)({},e.response.data).message;n({message:t,variant:"danger"},5)}))},X=j.d().shape({title:j.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter class title"),info:j.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(255,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 255 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter some description"),teacher:j.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter teacher name"),specialty:j.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("Enter teacher name"),pupils:j.a().of(j.f().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0448 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").max(128,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432.").required("\u0426\u0435 \u043f\u043e\u043b\u0435 \u0454 \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0438\u043c."))});return o.a.createElement(N.a,null,o.a.createElement("h2",{className:"text-center custom-font py-4"},h?"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438":"\u0414\u043e\u0434\u0430\u0442\u0438"," \u043a\u043b\u0430\u0441"),o.a.createElement(x.c,{initialValues:h?Object(s.a)({},t,{teacher:t.teacher.name,specialty:t.specialty.title,pupils:t.pupils.map((function(e){return e.name}))}):{title:"",info:"",teacher:"",specialty:"",pupils:[""]},enableReinitialize:!0,onSubmit:function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.resetForm,c=a.setErrors,e.next=3,M(t,c,n);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),validationSchema:X},(function(e){var a=e.handleSubmit,n=e.handleChange,r=e.handleBlur,c=e.values,s=e.touched,l=e.errors;return o.a.createElement(C.a,{"data-cy":"school-class-form",noValidate:!0,onSubmit:a,className:"text-left"},o.a.createElement(C.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(C.a.Group,{controlId:h?"school-class-title-input-".concat(t.id):"school-class-title-input",as:O.a,className:"mb-4"},o.a.createElement(C.a.Label,null,"\u041d\u0430\u0437\u0432\u0430 \u043a\u043b\u0430\u0441\u0443"),o.a.createElement(C.a.Control,{type:"text",name:"title","data-cy":"title-input",onChange:n,onBlur:r,value:c.title,isValid:s.title&&!l.title,isInvalid:s.title&&!!l.title}),o.a.createElement(C.a.Control.Feedback,{type:"invalid"},l.title))),o.a.createElement(C.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(C.a.Group,{controlId:h?"school-class-info-input-".concat(t.id):"school-class-info-input",as:O.a,className:"mb-4"},o.a.createElement(C.a.Label,null,"\u041e\u043f\u0438\u0441/\u0456\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u044f \u043f\u0440\u043e \u043a\u043b\u0430\u0441"),o.a.createElement(C.a.Control,{as:"textarea",rows:"3",name:"info","data-cy":"info-input",onChange:n,onBlur:r,value:c.info,isValid:s.info&&!l.info,isInvalid:s.info&&!!l.info}),o.a.createElement(C.a.Control.Feedback,{type:"invalid"},l.info))),o.a.createElement(C.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(C.a.Group,{controlId:h?"school-class-teacher-input-".concat(t.id):"school-class-teacher-input",as:O.a,className:"mb-4"},o.a.createElement(C.a.Label,null,"\u0412\u0447\u0456\u0442\u0435\u043b\u044c"),o.a.createElement(C.a.Control,{type:"text",name:"teacher","data-cy":"teacher-input",list:"teachers-list",onChange:n,onKeyUp:function(e){return function(e){if(e.length>=2){var t={value:e};E.teachers(t).then((function(e){G(e)})).catch((function(e){console.error(e)}))}}(e.target.value)},onBlur:r,value:c.teacher,isValid:s.teacher&&!l.teacher,isInvalid:s.teacher&&!!l.teacher}),o.a.createElement("datalist",{id:"teachers-list"},B.map((function(e){return o.a.createElement("option",{key:e,value:e})}))),o.a.createElement(C.a.Control.Feedback,{type:"invalid"},l.teacher))),o.a.createElement(C.a.Row,{className:"d-flex justify-content-center"},o.a.createElement(C.a.Group,{controlId:h?"school-class-specialty-input-".concat(t.id):"school-class-specialty-input",as:O.a,className:"mb-4"},o.a.createElement(C.a.Label,null,"\u0424\u0430\u0445 \u043a\u043b\u0430\u0441\u0443"),o.a.createElement(C.a.Control,{type:"text",name:"specialty","data-cy":"specialty-input",list:"specialties-list",onChange:n,onKeyUp:function(e){return function(e){if(e.length>=2){var t={value:e};E.specialties(t).then((function(e){D(e)})).catch((function(e){console.error(e)}))}}(e.target.value)},onBlur:r,value:c.specialty,isValid:s.specialty&&!l.specialty,isInvalid:s.specialty&&!!l.specialty}),o.a.createElement("datalist",{id:"specialties-list"},J.map((function(e){return o.a.createElement("option",{key:e,value:e})}))),o.a.createElement(C.a.Control.Feedback,{type:"invalid"},l.specialty))),o.a.createElement(x.b,{name:"pupils",render:function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(C.a.Label,null,"\u0423\u0447\u043d\u0456"),c.pupils&&c.pupils.length>0?c.pupils.map((function(t,a){return o.a.createElement(C.a.Row,{key:a,className:"d-flex justify-content-end"},o.a.createElement(O.a,{xs:12},o.a.createElement(C.a.Control,{type:"text",list:"pupils-list",className:"mb-2",name:"pupils[".concat(a,"]"),value:c.pupils[a],onChange:n,onKeyUp:function(e){return function(e){if(e.length>=2){var t={value:e};E.pupils(t).then((function(e){K(e)})).catch((function(e){console.error(e)}))}}(e.target.value)},isValid:s.pupils&&!l.pupils}),o.a.createElement("datalist",{id:"pupils-list"},A.map((function(e){return o.a.createElement("option",{key:e,value:e})})))),o.a.createElement(O.a,{xs:8},o.a.createElement(x.a,{name:"pupils[".concat(a,"]"),className:"border border-primary",render:function(e){return o.a.createElement("span",{className:"form-validation-error-mk2"},e)}})),o.a.createElement(O.a,{xs:4,className:"my-2 align-items-end border1 border-secondary"},o.a.createElement(w.a,{className:"d-flex justify-content-center"},o.a.createElement(O.a,{className:"pr-1"},o.a.createElement(S.a,{block:!0,variant:"outline-danger",size:"sm",onClick:function(){e.remove(a),H(e.form.values)}},o.a.createElement(g.a,{icon:k.i}))),o.a.createElement(O.a,{className:"pl-1"},o.a.createElement(S.a,{block:!0,variant:"outline-success",size:"sm",onClick:function(){e.push(""),H(e.form.values)}},o.a.createElement(g.a,{icon:k.k}))))))})):o.a.createElement(S.a,{className:"my-2",variant:V?"outline-danger":"outline-primary",varialt:"outline-primary",onClick:function(){e.push(""),H(e.form.values)}},"\u0414\u043e\u0434\u0430\u0442\u0438 \u0443\u0447\u043d\u044f"))}}),o.a.createElement(C.a.Row,{className:"d-flex justify-content-center text-center"},o.a.createElement(C.a.Group,{as:O.a,className:"pt-4"},o.a.createElement(I.a,{block:!0,className:"px-4 primary-color-shadow",variant:"primary",type:"submit",label:"\u0414\u043e\u0434\u0430\u0442\u0438"}))))})))}))}}]);
//# sourceMappingURL=0.bb971bfa.chunk.js.map